


node{
        def customImage

                stage('checkout') {

                checkout scm
                sh 'echo address $PWD'
                }

                stage('maven') {

                        sh 'echo $PWD'
                        sh 'docker run --rm --name taozhumall  -v "/opt/data/jenkins_home/workspace/${JOB_NAME}":/usr/src/mymaven -v /opt/data/maven/.m2/:/root/.m2/ -w /usr/src/mymaven maven:3.5.2-jdk-8-alpine mvn clean install -f baseservice/pom_image.xml'

                }

                stage('dockerbuild') {

                    customImage = docker.build("baeservice:0.1", "/var/jenkins_home/workspace/${JOB_NAME}/baseservice")
                }

                stage('dockerpush') {

                    docker.withRegistry('registry.lubanresearch.com:5000') {

                         customImage.push()
                    }
                }


}
